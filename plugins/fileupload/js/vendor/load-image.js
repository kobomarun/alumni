!function(a){"use strict";var b=function(a,c,d){var e,f,g=document.createElement("img");if(g.onerror=c,g.onload=function(){!f||d&&d.noRevoke||b.revokeObjectURL(f),c&&c(b.scale(g,d))},b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a))e=f=b.createObjectURL(a),g._type=a.type;else{if("string"!=typeof a)return!1;e=a,d&&d.crossOrigin&&(g.crossOrigin=d.crossOrigin)}return e?(g.src=e,g):b.readFile(a,function(a){var b=a.target;b&&b.result?g.src=b.result:c&&c(a)})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(a,b){var c,d,e,f,g=b.aspectRatio;if(!g)return b;c={};for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c.crop=!0,e=a.naturalWidth||a.width,f=a.naturalHeight||a.height,e/f>g?(c.maxWidth=f*g,c.maxHeight=f):(c.maxWidth=e,c.maxHeight=e/g),c},b.renderImageToCanvas=function(a,b,c,d,e,f,g,h,i,j){return a.getContext("2d").drawImage(b,c,d,e,f,g,h,i,j),a},b.hasCanvasOption=function(a){return a.canvas||a.crop||!!a.aspectRatio},b.scale=function(a,c){function d(){var a=Math.max((h||u)/u,(i||v)/v);a>1&&(u*=a,v*=a)}function e(){var a=Math.min((f||u)/u,(g||v)/v);1>a&&(u*=a,v*=a)}c=c||{};var f,g,h,i,j,k,l,m,n,o,p,q=document.createElement("canvas"),r=a.getContext||b.hasCanvasOption(c)&&q.getContext,s=a.naturalWidth||a.width,t=a.naturalHeight||a.height,u=s,v=t;if(r&&(c=b.getTransformedOptions(a,c),l=c.left||0,m=c.top||0,c.sourceWidth?(j=c.sourceWidth,void 0!==c.right&&void 0===c.left&&(l=s-j-c.right)):j=s-l-(c.right||0),c.sourceHeight?(k=c.sourceHeight,void 0!==c.bottom&&void 0===c.top&&(m=t-k-c.bottom)):k=t-m-(c.bottom||0),u=j,v=k),f=c.maxWidth,g=c.maxHeight,h=c.minWidth,i=c.minHeight,r&&f&&g&&c.crop?(u=f,v=g,p=j/k-f/g,0>p?(k=g*j/f,void 0===c.top&&void 0===c.bottom&&(m=(t-k)/2)):p>0&&(j=f*k/g,void 0===c.left&&void 0===c.right&&(l=(s-j)/2))):((c.contain||c.cover)&&(h=f=f||h,i=g=g||i),c.cover?(e(),d()):(d(),e())),r){if(n=c.pixelRatio,n>1&&(q.style.width=u+"px",q.style.height=v+"px",u*=n,v*=n,q.getContext("2d").scale(n,n)),o=c.downsamplingRatio,o>0&&1>o&&j>u&&k>v)for(;j*o>u;)q.width=j*o,q.height=k*o,b.renderImageToCanvas(q,a,l,m,j,k,0,0,q.width,q.height),j=q.width,k=q.height,a=document.createElement("canvas"),a.width=j,a.height=k,b.renderImageToCanvas(a,q,0,0,j,k,0,0,j,k);return q.width=u,q.height=v,b.transformCoordinates(q,c),b.renderImageToCanvas(q,a,l,m,j,k,0,0,u,v)}return a.width=u,a.height=v,a},b.createObjectURL=function(a){return c?c.createObjectURL(a):!1},b.revokeObjectURL=function(a){return c?c.revokeObjectURL(a):!1},b.readFile=function(a,b,c){if(window.FileReader){var d=new FileReader;if(d.onload=d.onerror=b,c=c||"readAsDataURL",d[c])return d[c](a),d}return!1},"function"==typeof define&&define.amd?define(function(){return b}):"object"==typeof module&&module.exports?module.exports=b:a.loadImage=b}(window);